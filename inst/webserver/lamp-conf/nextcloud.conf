<IfModule mod_alias.c>
    Alias /nextcloud /usr/share/webapps/nextcloud/
</IfModule>

<IfModule mpm_itk_module>
    AssignUserId nextcloud nextcloud
</IfModule>

<Directory /usr/share/webapps/nextcloud/>
    Options FollowSymlinks
    AllowOverride all
    Require all granted
</Directory>

<IfModule mod_ssl.c>
  <VirtualHost _default_:443>
    ServerAdmin postmaster@inkURI286
    ServerName blueURI286
    
    DocumentRoot /usr/share/webapps/nextcloud
    
    <FilesMatch \.php$>
        SetHandler "proxy:unix:/run/nextcloud/nextcloud.sock|fcgi://localhost/"
    </FilesMatch>
    
    ErrorLog "/var/log/httpd/blue-error_log"
    LogLevel warn
    CustomLog "/var/log/httpd/blue-access_log" combined

    SSLEngine on
    SSLCertificateFile  "/etc/ssl/server/server.crt"
    SSLCertificateKeyFile "/etc/ssl/server/server.key"
    SSLOpenSSLConfCmd DHParameters "/etc/ssl/server/dhparams.pem"
    #INKVERB-INKCERT=INK_NOT_YET

    BrowserMatch "MSIE [2-6]" \
        nokeepalive ssl-unclean-shutdown \
        downgrade-1.0 force-response-1.0
    BrowserMatch "MSIE [17-9]" ssl-unclean-shutdown

## Commented because this may not be necessary as a Linux app, we'll see
# To resolve the Nextcloud Strict Transport Security error message in the admin area
#  <IfModule mod_headers.c>
#    Header always set Strict-Transport-Security "max-age=15768000; includeSubDomains; preload"
#  </IfModule>
##

## Commented because this is run as a Linux app, not as a web app
#    <Directory "/srv/www/html/blue">
#      Options Indexes FollowSymLinks MultiViews
#      AllowOverride All
#      Require all granted
#      Order allow,deny
#      allow from all
# This Dav off is added by DigitalOcean's tutorial
#      <IfModule mod_dav.c>
#        Dav off
#      </IfModule>
#    </Directory>
#
#    <FilesMatch "\.(cgi|shtml|phtml|php)$">
#        SSLOptions +StdEnvVars
#    </FilesMatch>
#    <Directory /srv/www/html/blue>
#        SSLOptions +StdEnvVars
#    </Directory>
##

  </VirtualHost>
</IfModule>

# Redirects all traffic to https
  <VirtualHost *:80>
    ServerName blueURI286
    Redirect permanent / https://blueURI286/
  </VirtualHost>

